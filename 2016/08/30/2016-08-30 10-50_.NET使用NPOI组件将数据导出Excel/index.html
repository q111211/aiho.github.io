<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"aiho.site","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content=".NET调用NPOI组件导入导出Excel**的操作类**　　此NPOI操作类的优点如下：（1）支持web及winform从DataTable导出到Excel；  （2）生成速度很快；（3）准确判断数据类型，不会出现身份证转数值等问题；（4）如果单页条数大于65535时会新建工作表；  （5）列宽自适应； NPOI操作类 ![](https:&#x2F;&#x2F;images.cnblogs.com&#x2F;Outlini">
<meta property="og:type" content="article">
<meta property="og:title" content=".NET使用NPOI组件将数据导出Excel">
<meta property="og:url" content="http://aiho.site/2016/08/30/2016-08-30%2010-50_.NET%E4%BD%BF%E7%94%A8NPOI%E7%BB%84%E4%BB%B6%E5%B0%86%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%87%BAExcel/index.html">
<meta property="og:site_name" content="aiho.site">
<meta property="og:description" content=".NET调用NPOI组件导入导出Excel**的操作类**　　此NPOI操作类的优点如下：（1）支持web及winform从DataTable导出到Excel；  （2）生成速度很快；（3）准确判断数据类型，不会出现身份证转数值等问题；（4）如果单页条数大于65535时会新建工作表；  （5）列宽自适应； NPOI操作类 ![](https:&#x2F;&#x2F;images.cnblogs.com&#x2F;Outlini">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2016-08-30T02:50:00.000Z">
<meta property="article:modified_time" content="2020-05-27T16:08:12.154Z">
<meta property="article:author" content="Li ChengHu">
<meta property="article:tag" content="aiho|aiho.site|aiho���˲���">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://aiho.site/2016/08/30/2016-08-30%2010-50_.NET%E4%BD%BF%E7%94%A8NPOI%E7%BB%84%E4%BB%B6%E5%B0%86%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%87%BAExcel/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>.NET使用NPOI组件将数据导出Excel | aiho.site</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">aiho.site</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">aiho</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://aiho.site/2016/08/30/2016-08-30%2010-50_.NET%E4%BD%BF%E7%94%A8NPOI%E7%BB%84%E4%BB%B6%E5%B0%86%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%87%BAExcel/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Li ChengHu">
      <meta itemprop="description" content="��ͨ��ֻ�뵽��ζȹ�ʱ�䣬�в��ܵ����跨����ʱ�䡣�����屾��">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="aiho.site">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          .NET使用NPOI组件将数据导出Excel
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2016-08-30 10:50:00" itemprop="dateCreated datePublished" datetime="2016-08-30T10:50:00+08:00">2016-08-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-05-28 00:08:12" itemprop="dateModified" datetime="2020-05-28T00:08:12+08:00">2020-05-28</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p><strong>.NET调用NPOI组件导入导出Excel**</strong>的操作类<br>**　　此NPOI操作类的优点如下：<br>（1）支持web及winform从DataTable导出到Excel； </p>
<p>（2）生成速度很快；<br>（3）准确判断数据类型，不会出现身份证转数值等问题；<br>（4）如果单页条数大于65535时会新建工作表； </p>
<p>（5）列宽自适应；</p>
<p><strong>NPOI操作类</strong></p>
<div class="cnblogs_code" onclick="cnblogs_code_show('bd02877a-7c28-428a-a3bd-9f50d6119057')">![](https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif)![](https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif)
<div id="cnblogs_code_open_bd02877a-7c28-428a-a3bd-9f50d6119057" class="cnblogs_code_hide">

<p><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> NPOIHelper<br>        {<br>            </span><span style="color: #808080;">///</span> <span style="color: #808080;"><summary></span><br>            <span style="color: #808080;">///</span><span style="color: #008000;"> DataTable导出到Excel文件<br>            </span><span style="color: #808080;">///</span> <span style="color: #808080;"></summary></span><br>            <span style="color: #808080;">///</span> <span style="color: #808080;"><param name="dtSource"></span><span style="color: #008000;">源DataTable</span><span style="color: #808080;"></param></span><br>            <span style="color: #808080;">///</span> <span style="color: #808080;"><param name="strHeaderText"></span><span style="color: #008000;">表头文本</span><span style="color: #808080;"></param></span><br>            <span style="color: #808080;">///</span> <span style="color: #808080;"><param name="strFileName"></span><span style="color: #008000;">保存位置</span><span style="color: #808080;"></param></span><br>            <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Export(DataTable dtSource, <span style="color: #0000ff;">string</span> strHeaderText, <span style="color: #0000ff;">string</span><span style="color: #000000;"> strFileName)<br>            {<br>                </span><span style="color: #0000ff;">using</span> (MemoryStream ms =<span style="color: #000000;"> Export(dtSource, strHeaderText))<br>                {<br>                    </span><span style="color: #0000ff;">using</span> (FileStream fs = <span style="color: #0000ff;">new</span><span style="color: #000000;"> FileStream(strFileName, FileMode.Create, FileAccess.Write))<br>                    {<br>                        </span><span style="color: #0000ff;">byte</span>[] data =<span style="color: #000000;"> ms.ToArray();<br>                        fs.Write(data, </span><span style="color: #800080;">0</span><span style="color: #000000;">, data.Length);<br>                        fs.Flush();<br>                    }<br>                }<br>            }</p>
<pre><code>        &lt;/span&gt;&lt;span style=&quot;color: #808080;&quot;&gt;///&lt;/span&gt; &lt;span style=&quot;color: #808080;&quot;&gt;&lt;summary&gt;&lt;/span&gt;
        &lt;span style=&quot;color: #808080;&quot;&gt;///&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt; DataTable导出到Excel的MemoryStream
        &lt;/span&gt;&lt;span style=&quot;color: #808080;&quot;&gt;///&lt;/span&gt; &lt;span style=&quot;color: #808080;&quot;&gt;&lt;/summary&gt;&lt;/span&gt;
        &lt;span style=&quot;color: #808080;&quot;&gt;///&lt;/span&gt; &lt;span style=&quot;color: #808080;&quot;&gt;&lt;param name=&quot;dtSource&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;源DataTable&lt;/span&gt;&lt;span style=&quot;color: #808080;&quot;&gt;&lt;/param&gt;&lt;/span&gt;
        &lt;span style=&quot;color: #808080;&quot;&gt;///&lt;/span&gt; &lt;span style=&quot;color: #808080;&quot;&gt;&lt;param name=&quot;strHeaderText&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;表头文本&lt;/span&gt;&lt;span style=&quot;color: #808080;&quot;&gt;&lt;/param&gt;&lt;/span&gt;
        &lt;span style=&quot;color: #0000ff;&quot;&gt;public&lt;/span&gt; &lt;span style=&quot;color: #0000ff;&quot;&gt;static&lt;/span&gt; MemoryStream Export(DataTable dtSource, &lt;span style=&quot;color: #0000ff;&quot;&gt;string&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt; strHeaderText)
        {
            HSSFWorkbook workbook &lt;/span&gt;= &lt;span style=&quot;color: #0000ff;&quot;&gt;new&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt; HSSFWorkbook();
            HSSFSheet sheet &lt;/span&gt;=&lt;span style=&quot;color: #000000;&quot;&gt; workbook.CreateSheet();

            &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;#region&lt;/span&gt; 右击文件 属性信息&lt;span style=&quot;color: #000000;&quot;&gt;
            {
                DocumentSummaryInformation dsi &lt;/span&gt;=&lt;span style=&quot;color: #000000;&quot;&gt; PropertySetFactory.CreateDocumentSummaryInformation();
                dsi.Company &lt;/span&gt;= &lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;NPOI&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;;
                workbook.DocumentSummaryInformation &lt;/span&gt;=&lt;span style=&quot;color: #000000;&quot;&gt; dsi;

                SummaryInformation si &lt;/span&gt;=&lt;span style=&quot;color: #000000;&quot;&gt; PropertySetFactory.CreateSummaryInformation();
                si.Author &lt;/span&gt;= &lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;文件作者信息&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;; &lt;span style=&quot;color: #008000;&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;填加xls文件作者信息&lt;/span&gt;
                si.ApplicationName = &lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;创建程序信息&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;; &lt;span style=&quot;color: #008000;&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;填加xls文件创建程序信息&lt;/span&gt;
                si.LastAuthor = &lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;最后保存者信息&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;; &lt;span style=&quot;color: #008000;&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;填加xls文件最后保存者信息&lt;/span&gt;
                si.Comments = &lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;作者信息&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;; &lt;span style=&quot;color: #008000;&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;填加xls文件作者信息&lt;/span&gt;
                si.Title = &lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;标题信息&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;; &lt;span style=&quot;color: #008000;&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;填加xls文件标题信息&lt;/span&gt;
                si.Subject = &lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;主题信息&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;;&lt;span style=&quot;color: #008000;&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;填加文件主题信息&lt;/span&gt;
                si.CreateDateTime =&lt;span style=&quot;color: #000000;&quot;&gt; DateTime.Now;
                workbook.SummaryInformation &lt;/span&gt;=&lt;span style=&quot;color: #000000;&quot;&gt; si;
            }
            &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;#endregion&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;

            HSSFCellStyle dateStyle &lt;/span&gt;=&lt;span style=&quot;color: #000000;&quot;&gt; workbook.CreateCellStyle();
            HSSFDataFormat format &lt;/span&gt;=&lt;span style=&quot;color: #000000;&quot;&gt; workbook.CreateDataFormat();
            dateStyle.DataFormat &lt;/span&gt;= format.GetFormat(&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;yyyy-mm-dd&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;);

            &lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;取得列宽&lt;/span&gt;
            &lt;span style=&quot;color: #0000ff;&quot;&gt;int&lt;/span&gt;[] arrColWidth = &lt;span style=&quot;color: #0000ff;&quot;&gt;new&lt;/span&gt; &lt;span style=&quot;color: #0000ff;&quot;&gt;int&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;[dtSource.Columns.Count];
            &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;foreach&lt;/span&gt; (DataColumn item &lt;span style=&quot;color: #0000ff;&quot;&gt;in&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt; dtSource.Columns)
            {
                arrColWidth[item.Ordinal] &lt;/span&gt;= Encoding.GetEncoding(&lt;span style=&quot;color: #800080;&quot;&gt;936&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;).GetBytes(item.ColumnName.ToString()).Length;
            }
            &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;for&lt;/span&gt; (&lt;span style=&quot;color: #0000ff;&quot;&gt;int&lt;/span&gt; i = &lt;span style=&quot;color: #800080;&quot;&gt;0&lt;/span&gt;; i &lt; dtSource.Rows.Count; i++&lt;span style=&quot;color: #000000;&quot;&gt;)
            {
                &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;for&lt;/span&gt; (&lt;span style=&quot;color: #0000ff;&quot;&gt;int&lt;/span&gt; j = &lt;span style=&quot;color: #800080;&quot;&gt;0&lt;/span&gt;; j &lt; dtSource.Columns.Count; j++&lt;span style=&quot;color: #000000;&quot;&gt;)
                {
                    &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;int&lt;/span&gt; intTemp = Encoding.GetEncoding(&lt;span style=&quot;color: #800080;&quot;&gt;936&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;).GetBytes(dtSource.Rows[i][j].ToString()).Length;
                    &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;if&lt;/span&gt; (intTemp &gt;&lt;span style=&quot;color: #000000;&quot;&gt; arrColWidth[j])
                    {
                        arrColWidth[j] &lt;/span&gt;=&lt;span style=&quot;color: #000000;&quot;&gt; intTemp;
                    }
                }
            }
            &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;int&lt;/span&gt; rowIndex = &lt;span style=&quot;color: #800080;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;;
            &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;foreach&lt;/span&gt; (DataRow row &lt;span style=&quot;color: #0000ff;&quot;&gt;in&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt; dtSource.Rows)
            {
                &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;#region&lt;/span&gt; 新建表，填充表头，填充列头，样式
                &lt;span style=&quot;color: #0000ff;&quot;&gt;if&lt;/span&gt; (rowIndex == &lt;span style=&quot;color: #800080;&quot;&gt;10000&lt;/span&gt; || rowIndex == &lt;span style=&quot;color: #800080;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;)
                {
                    &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;if&lt;/span&gt; (rowIndex != &lt;span style=&quot;color: #800080;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;)
                    {
                        &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;if&lt;/span&gt; (strHeaderText.Length &gt; &lt;span style=&quot;color: #800080;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;)
                            sheet &lt;/span&gt;=&lt;span style=&quot;color: #000000;&quot;&gt; workbook.CreateSheet(strHeaderText);
                        &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;else&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;
                            sheet &lt;/span&gt;=&lt;span style=&quot;color: #000000;&quot;&gt; workbook.CreateSheet();
                    }

                    &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;#region&lt;/span&gt; 表头及样式&lt;span style=&quot;color: #000000;&quot;&gt;
                    {
                        &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;if&lt;/span&gt; (strHeaderText.Length &gt; &lt;span style=&quot;color: #800080;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;)
                        {
                            HSSFRow headerRow &lt;/span&gt;= sheet.CreateRow(&lt;span style=&quot;color: #800080;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;);
                            headerRow.HeightInPoints &lt;/span&gt;= &lt;span style=&quot;color: #800080;&quot;&gt;25&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;;
                            headerRow.CreateCell(&lt;/span&gt;&lt;span style=&quot;color: #800080;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;).SetCellValue(strHeaderText);

                            HSSFCellStyle headStyle &lt;/span&gt;=&lt;span style=&quot;color: #000000;&quot;&gt; workbook.CreateCellStyle();
                            headStyle.Alignment &lt;/span&gt;=&lt;span style=&quot;color: #000000;&quot;&gt; NPOI.HSSF.UserModel.HSSFCellStyle.ALIGN_CENTER;
                            HSSFFont font &lt;/span&gt;=&lt;span style=&quot;color: #000000;&quot;&gt; workbook.CreateFont();
                            font.FontHeightInPoints &lt;/span&gt;= &lt;span style=&quot;color: #800080;&quot;&gt;20&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;;
                            font.Boldweight &lt;/span&gt;= &lt;span style=&quot;color: #800080;&quot;&gt;700&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;;
                            headStyle.SetFont(font);
                            headerRow.GetCell(&lt;/span&gt;&lt;span style=&quot;color: #800080;&quot;&gt;0&lt;/span&gt;).CellStyle =&lt;span style=&quot;color: #000000;&quot;&gt; headStyle;
                            sheet.AddMergedRegion(&lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;new&lt;/span&gt; Region(&lt;span style=&quot;color: #800080;&quot;&gt;0&lt;/span&gt;, &lt;span style=&quot;color: #800080;&quot;&gt;0&lt;/span&gt;, &lt;span style=&quot;color: #800080;&quot;&gt;0&lt;/span&gt;, dtSource.Columns.Count - &lt;span style=&quot;color: #800080;&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;));
                        }
                        &lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;headerRow.Dispose();&lt;/span&gt;
&lt;span style=&quot;color: #000000;&quot;&gt;                    }
                    &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;#endregion&lt;/span&gt;

                    &lt;span style=&quot;color: #0000ff;&quot;&gt;#region&lt;/span&gt; 列头及样式&lt;span style=&quot;color: #000000;&quot;&gt;
                    {
                        HSSFRow headerRow &lt;/span&gt;= sheet.CreateRow(&lt;span style=&quot;color: #800080;&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;);
                        HSSFCellStyle headStyle &lt;/span&gt;=&lt;span style=&quot;color: #000000;&quot;&gt; workbook.CreateCellStyle();
                        headStyle.Alignment &lt;/span&gt;=&lt;span style=&quot;color: #000000;&quot;&gt; NPOI.HSSF.UserModel.HSSFCellStyle.ALIGN_CENTER;
                        HSSFFont font &lt;/span&gt;=&lt;span style=&quot;color: #000000;&quot;&gt; workbook.CreateFont();
                        font.FontHeightInPoints &lt;/span&gt;= &lt;span style=&quot;color: #800080;&quot;&gt;10&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;;
                        font.Boldweight &lt;/span&gt;= &lt;span style=&quot;color: #800080;&quot;&gt;700&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;;
                        headStyle.SetFont(font);
                        &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;foreach&lt;/span&gt; (DataColumn column &lt;span style=&quot;color: #0000ff;&quot;&gt;in&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt; dtSource.Columns)
                        {
                            headerRow.CreateCell(column.Ordinal).SetCellValue(column.ColumnName);
                            headerRow.GetCell(column.Ordinal).CellStyle &lt;/span&gt;=&lt;span style=&quot;color: #000000;&quot;&gt; headStyle;

                            &lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;设置列宽&lt;/span&gt;
                            sheet.SetColumnWidth(column.Ordinal, (arrColWidth[column.Ordinal] + &lt;span style=&quot;color: #800080;&quot;&gt;1&lt;/span&gt;) * &lt;span style=&quot;color: #800080;&quot;&gt;256&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;);
                        }
                        &lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt; headerRow.Dispose();&lt;/span&gt;
&lt;span style=&quot;color: #000000;&quot;&gt;                    }
                    &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;#endregion&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;

                    rowIndex &lt;/span&gt;= &lt;span style=&quot;color: #800080;&quot;&gt;2&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;;
                }
                &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;#endregion&lt;/span&gt;

                &lt;span style=&quot;color: #0000ff;&quot;&gt;#region&lt;/span&gt; 填充内容&lt;span style=&quot;color: #000000;&quot;&gt;
                HSSFRow dataRow &lt;/span&gt;=&lt;span style=&quot;color: #000000;&quot;&gt; sheet.CreateRow(rowIndex);
                &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;foreach&lt;/span&gt; (DataColumn column &lt;span style=&quot;color: #0000ff;&quot;&gt;in&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt; dtSource.Columns)
                {
                    HSSFCell newCell &lt;/span&gt;=&lt;span style=&quot;color: #000000;&quot;&gt; dataRow.CreateCell(column.Ordinal);

                    &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;string&lt;/span&gt; drValue =&lt;span style=&quot;color: #000000;&quot;&gt; row[column].ToString();

                    &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;switch&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt; (column.DataType.ToString())
                    {
                        &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;case&lt;/span&gt; &lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;System.String&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;:&lt;span style=&quot;color: #008000;&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;字符串类型&lt;/span&gt;
                            drValue = drValue.Replace(&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&amp;&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;, &lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&amp;&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;);
                            drValue &lt;/span&gt;= drValue.Replace(&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&gt;&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;, &lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&gt;&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;);
                            drValue &lt;/span&gt;= drValue.Replace(&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&lt;&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;, &lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&lt;&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;);
                            newCell.SetCellValue(drValue);
                            &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;break&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;;
                        &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;case&lt;/span&gt; &lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;System.DateTime&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;:&lt;span style=&quot;color: #008000;&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;日期类型&lt;/span&gt;
&lt;span style=&quot;color: #000000;&quot;&gt;                            DateTime dateV;
                            DateTime.TryParse(drValue, &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;out&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt; dateV);
                            newCell.SetCellValue(dateV);

                            newCell.CellStyle &lt;/span&gt;= dateStyle;&lt;span style=&quot;color: #008000;&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;格式化显示&lt;/span&gt;
                            &lt;span style=&quot;color: #0000ff;&quot;&gt;break&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;;
                        &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;case&lt;/span&gt; &lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;System.Boolean&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;:&lt;span style=&quot;color: #008000;&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;布尔型&lt;/span&gt;
                            &lt;span style=&quot;color: #0000ff;&quot;&gt;bool&lt;/span&gt; boolV = &lt;span style=&quot;color: #0000ff;&quot;&gt;false&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;;
                            &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;bool&lt;/span&gt;.TryParse(drValue, &lt;span style=&quot;color: #0000ff;&quot;&gt;out&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt; boolV);
                            newCell.SetCellValue(boolV);
                            &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;break&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;;
                        &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;case&lt;/span&gt; &lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;System.Int16&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;:&lt;span style=&quot;color: #008000;&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;整型&lt;/span&gt;
                        &lt;span style=&quot;color: #0000ff;&quot;&gt;case&lt;/span&gt; &lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;System.Int32&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;:&lt;span style=&quot;color: #008000;&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;整型&lt;/span&gt;
                        &lt;span style=&quot;color: #0000ff;&quot;&gt;case&lt;/span&gt; &lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;System.Int64&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;:&lt;span style=&quot;color: #008000;&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;整型&lt;/span&gt;
                        &lt;span style=&quot;color: #0000ff;&quot;&gt;case&lt;/span&gt; &lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;System.Int&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;:&lt;span style=&quot;color: #008000;&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;整型&lt;/span&gt;
                            &lt;span style=&quot;color: #0000ff;&quot;&gt;int&lt;/span&gt; invV = &lt;span style=&quot;color: #800080;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;;
                            &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;int&lt;/span&gt;.TryParse(drValue, &lt;span style=&quot;color: #0000ff;&quot;&gt;out&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt; invV);
                            newCell.SetCellValue(invV);
                            &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;break&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;;

                        &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;case&lt;/span&gt; &lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;System.Byte&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;:
                            &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;int&lt;/span&gt; intV = &lt;span style=&quot;color: #800080;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;;
                            &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;int&lt;/span&gt;.TryParse(drValue, &lt;span style=&quot;color: #0000ff;&quot;&gt;out&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt; intV);
                            newCell.SetCellValue(intV);
                            &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;break&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;;
                        &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;case&lt;/span&gt; &lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;System.Decimal&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;:&lt;span style=&quot;color: #008000;&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;浮点型                           &lt;/span&gt;
                        &lt;span style=&quot;color: #0000ff;&quot;&gt;case&lt;/span&gt; &lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;System.Double&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;:
                            &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;double&lt;/span&gt; doubV = &lt;span style=&quot;color: #800080;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;;
                            &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;double&lt;/span&gt;.TryParse(drValue, &lt;span style=&quot;color: #0000ff;&quot;&gt;out&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt; doubV);
                            newCell.SetCellValue(doubV);
                            &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;break&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;;
                        &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;case&lt;/span&gt; &lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;System.DBNull&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;:&lt;span style=&quot;color: #008000;&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;空值处理&lt;/span&gt;
                            newCell.SetCellValue(&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;);
                            &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;break&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;;
                        &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;default&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;:
                            newCell.SetCellValue(&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;);
                            &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;break&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;;
                    }

                }
                &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;#endregion&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;

                rowIndex&lt;/span&gt;++&lt;span style=&quot;color: #000000;&quot;&gt;;
            }
            &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;using&lt;/span&gt; (MemoryStream ms = &lt;span style=&quot;color: #0000ff;&quot;&gt;new&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt; MemoryStream())
            {
                workbook.Write(ms);
                ms.Flush();
                ms.Position &lt;/span&gt;= &lt;span style=&quot;color: #800080;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;;

                &lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;sheet.Dispose();
                &lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;workbook.Dispose();&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;一般只用写这一个就OK了，他会遍历并释放所有资源，但当前版本有问题所以只释放sheet&lt;/span&gt;
                &lt;span style=&quot;color: #0000ff;&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt; ms;
            }
        }

        &lt;/span&gt;&lt;span style=&quot;color: #808080;&quot;&gt;///&lt;/span&gt; &lt;span style=&quot;color: #808080;&quot;&gt;&lt;summary&gt;&lt;/span&gt;
        &lt;span style=&quot;color: #808080;&quot;&gt;///&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt; 用于Web导出
        &lt;/span&gt;&lt;span style=&quot;color: #808080;&quot;&gt;///&lt;/span&gt; &lt;span style=&quot;color: #808080;&quot;&gt;&lt;/summary&gt;&lt;/span&gt;
        &lt;span style=&quot;color: #808080;&quot;&gt;///&lt;/span&gt; &lt;span style=&quot;color: #808080;&quot;&gt;&lt;param name=&quot;dtSource&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;源DataTable&lt;/span&gt;&lt;span style=&quot;color: #808080;&quot;&gt;&lt;/param&gt;&lt;/span&gt;
        &lt;span style=&quot;color: #808080;&quot;&gt;///&lt;/span&gt; &lt;span style=&quot;color: #808080;&quot;&gt;&lt;param name=&quot;strHeaderText&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;表头文本&lt;/span&gt;&lt;span style=&quot;color: #808080;&quot;&gt;&lt;/param&gt;&lt;/span&gt;
        &lt;span style=&quot;color: #808080;&quot;&gt;///&lt;/span&gt; &lt;span style=&quot;color: #808080;&quot;&gt;&lt;param name=&quot;strFileName&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;文件名&lt;/span&gt;&lt;span style=&quot;color: #808080;&quot;&gt;&lt;/param&gt;&lt;/span&gt;
        &lt;span style=&quot;color: #0000ff;&quot;&gt;public&lt;/span&gt; &lt;span style=&quot;color: #0000ff;&quot;&gt;static&lt;/span&gt; &lt;span style=&quot;color: #0000ff;&quot;&gt;void&lt;/span&gt; ExportByWeb(DataTable dtSource, &lt;span style=&quot;color: #0000ff;&quot;&gt;string&lt;/span&gt; strHeaderText, &lt;span style=&quot;color: #0000ff;&quot;&gt;string&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt; strFileName)
        {
            HttpContext curContext &lt;/span&gt;=&lt;span style=&quot;color: #000000;&quot;&gt; HttpContext.Current;

            &lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt; 设置编码和附件格式&lt;/span&gt;
            curContext.Response.ContentType = &lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;application/vnd.ms-excel&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;;
            curContext.Response.ContentEncoding &lt;/span&gt;=&lt;span style=&quot;color: #000000;&quot;&gt; Encoding.UTF8;
            curContext.Response.Charset &lt;/span&gt;= &lt;span style=&quot;color: #800000;&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;;
            curContext.Response.AppendHeader(&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;Content-Disposition&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;,
                &lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;attachment;filename=&lt;/span&gt;&lt;span style=&quot;color: #800000;&quot;&gt;&quot;&lt;/span&gt; +&lt;span style=&quot;color: #000000;&quot;&gt; HttpUtility.UrlEncode(strFileName, Encoding.UTF8));

            curContext.Response.BinaryWrite(Export(dtSource, strHeaderText).GetBuffer());
            curContext.Response.End();
        }

        &lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;public static DataTable Import(string strFileName, int sheetindex)
        &lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;{
        &lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;    return Import(strFileName, sheetindex);
        &lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;}&lt;/span&gt;
        &lt;span style=&quot;color: #808080;&quot;&gt;///&lt;/span&gt; &lt;span style=&quot;color: #808080;&quot;&gt;&lt;summary&gt;&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;读取excel
        &lt;/span&gt;&lt;span style=&quot;color: #808080;&quot;&gt;///&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt; 默认第一行为标头
        &lt;/span&gt;&lt;span style=&quot;color: #808080;&quot;&gt;///&lt;/span&gt; &lt;span style=&quot;color: #808080;&quot;&gt;&lt;/summary&gt;&lt;/span&gt;
        &lt;span style=&quot;color: #808080;&quot;&gt;///&lt;/span&gt; &lt;span style=&quot;color: #808080;&quot;&gt;&lt;param name=&quot;strFileName&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt;excel文档路径&lt;/span&gt;&lt;span style=&quot;color: #808080;&quot;&gt;&lt;/param&gt;&lt;/span&gt;
        &lt;span style=&quot;color: #808080;&quot;&gt;///&lt;/span&gt; &lt;span style=&quot;color: #808080;&quot;&gt;&lt;returns&gt;&lt;/returns&gt;&lt;/span&gt;
        &lt;span style=&quot;color: #0000ff;&quot;&gt;public&lt;/span&gt; &lt;span style=&quot;color: #0000ff;&quot;&gt;static&lt;/span&gt; DataTable Import(&lt;span style=&quot;color: #0000ff;&quot;&gt;string&lt;/span&gt; strFileName, &lt;span style=&quot;color: #0000ff;&quot;&gt;int&lt;/span&gt; sheetindex, &lt;span style=&quot;color: #0000ff;&quot;&gt;int&lt;/span&gt; recordcount, &lt;span style=&quot;color: #0000ff;&quot;&gt;int&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt; topcount)
        {
            DataTable dt &lt;/span&gt;= &lt;span style=&quot;color: #0000ff;&quot;&gt;new&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt; DataTable();

            HSSFWorkbook hssfworkbook;
            &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;using&lt;/span&gt; (FileStream file = &lt;span style=&quot;color: #0000ff;&quot;&gt;new&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt; FileStream(strFileName, FileMode.Open, FileAccess.Read))
            {
                hssfworkbook &lt;/span&gt;= &lt;span style=&quot;color: #0000ff;&quot;&gt;new&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt; HSSFWorkbook(file);
            }

            HSSFSheet sheet &lt;/span&gt;=&lt;span style=&quot;color: #000000;&quot;&gt; hssfworkbook.GetSheetAt(sheetindex);
            System.Collections.IEnumerator rows &lt;/span&gt;=&lt;span style=&quot;color: #000000;&quot;&gt; sheet.GetRowEnumerator();
            &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;if&lt;/span&gt; (topcount == &lt;span style=&quot;color: #800080;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;)
                topcount &lt;/span&gt;= &lt;span style=&quot;color: #800080;&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;;
            HSSFRow headerRow &lt;/span&gt;= sheet.GetRow(&lt;span style=&quot;color: #800080;&quot;&gt;0&lt;/span&gt; + topcount - &lt;span style=&quot;color: #800080;&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;);
            &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;int&lt;/span&gt; cellCount =&lt;span style=&quot;color: #000000;&quot;&gt; headerRow.LastCellNum;

            &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;for&lt;/span&gt; (&lt;span style=&quot;color: #0000ff;&quot;&gt;int&lt;/span&gt; j = &lt;span style=&quot;color: #800080;&quot;&gt;0&lt;/span&gt;; j &lt; cellCount; j++&lt;span style=&quot;color: #000000;&quot;&gt;)
            {
                HSSFCell cell &lt;/span&gt;=&lt;span style=&quot;color: #000000;&quot;&gt; headerRow.GetCell(j);
                &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;if&lt;/span&gt; (cell == &lt;span style=&quot;color: #0000ff;&quot;&gt;null&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;)
                    &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;continue&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;;
                dt.Columns.Add(cell.ToString());
            }

            &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;for&lt;/span&gt; (&lt;span style=&quot;color: #0000ff;&quot;&gt;int&lt;/span&gt; i = (sheet.FirstRowNum + topcount); i &lt;= sheet.LastRowNum; i++&lt;span style=&quot;color: #000000;&quot;&gt;)
            {
                &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;if&lt;/span&gt; (recordcount &gt; &lt;span style=&quot;color: #800080;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;)
                {
                    &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;if&lt;/span&gt; (i &gt; (recordcount + &lt;span style=&quot;color: #800080;&quot;&gt;2&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;))
                        &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;break&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;;
                }
                HSSFRow row &lt;/span&gt;=&lt;span style=&quot;color: #000000;&quot;&gt; sheet.GetRow(i);
                DataRow dataRow &lt;/span&gt;=&lt;span style=&quot;color: #000000;&quot;&gt; dt.NewRow();

                &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;for&lt;/span&gt; (&lt;span style=&quot;color: #0000ff;&quot;&gt;int&lt;/span&gt; j = row.FirstCellNum; j &lt; cellCount; j++&lt;span style=&quot;color: #000000;&quot;&gt;)
                {
                    &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;if&lt;/span&gt; (row.GetCell(j) != &lt;span style=&quot;color: #0000ff;&quot;&gt;null&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;)
                    {
                        &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;if&lt;/span&gt;(dt.Columns.Count&gt;&lt;span style=&quot;color: #000000;&quot;&gt;j)
                           dataRow[j] &lt;/span&gt;=&lt;span style=&quot;color: #000000;&quot;&gt; row.GetCell(j).ToString();
                    }
                }

                dt.Rows.Add(dataRow);
            }
            &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt; dt;
        }

        &lt;/span&gt;&lt;span style=&quot;color: #808080;&quot;&gt;///&lt;/span&gt; &lt;span style=&quot;color: #808080;&quot;&gt;&lt;summary&gt;&lt;/span&gt;
        &lt;span style=&quot;color: #808080;&quot;&gt;///&lt;/span&gt;&lt;span style=&quot;color: #008000;&quot;&gt; 获取Sheet列信息
        &lt;/span&gt;&lt;span style=&quot;color: #808080;&quot;&gt;///&lt;/span&gt; &lt;span style=&quot;color: #808080;&quot;&gt;&lt;/summary&gt;&lt;/span&gt;
        &lt;span style=&quot;color: #808080;&quot;&gt;///&lt;/span&gt; &lt;span style=&quot;color: #808080;&quot;&gt;&lt;param name=&quot;strFileName&quot;&gt;&lt;/param&gt;&lt;/span&gt;
        &lt;span style=&quot;color: #808080;&quot;&gt;///&lt;/span&gt; &lt;span style=&quot;color: #808080;&quot;&gt;&lt;param name=&quot;sheetindex&quot;&gt;&lt;/param&gt;&lt;/span&gt;
        &lt;span style=&quot;color: #808080;&quot;&gt;///&lt;/span&gt; &lt;span style=&quot;color: #808080;&quot;&gt;&lt;param name=&quot;topcount&quot;&gt;&lt;/param&gt;&lt;/span&gt;
        &lt;span style=&quot;color: #808080;&quot;&gt;///&lt;/span&gt; &lt;span style=&quot;color: #808080;&quot;&gt;&lt;returns&gt;&lt;/returns&gt;&lt;/span&gt;
        &lt;span style=&quot;color: #0000ff;&quot;&gt;public&lt;/span&gt; &lt;span style=&quot;color: #0000ff;&quot;&gt;static&lt;/span&gt; System.Collections.Generic.List&lt;&lt;span style=&quot;color: #0000ff;&quot;&gt;string&lt;/span&gt;&gt; GetSheetColumns(&lt;span style=&quot;color: #0000ff;&quot;&gt;string&lt;/span&gt; strFileName, &lt;span style=&quot;color: #0000ff;&quot;&gt;int&lt;/span&gt; sheetindex, &lt;span style=&quot;color: #0000ff;&quot;&gt;int&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt; topcount)
        {

            HSSFWorkbook hssfworkbook;
            &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;using&lt;/span&gt; (FileStream file = &lt;span style=&quot;color: #0000ff;&quot;&gt;new&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt; FileStream(strFileName, FileMode.Open, FileAccess.Read))
            {
                hssfworkbook &lt;/span&gt;= &lt;span style=&quot;color: #0000ff;&quot;&gt;new&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt; HSSFWorkbook(file);
            }

            HSSFSheet sheet &lt;/span&gt;=&lt;span style=&quot;color: #000000;&quot;&gt; hssfworkbook.GetSheetAt(sheetindex);
            System.Collections.IEnumerator rows &lt;/span&gt;=&lt;span style=&quot;color: #000000;&quot;&gt; sheet.GetRowEnumerator();
            &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;if&lt;/span&gt; (topcount &lt; &lt;span style=&quot;color: #800080;&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;)
                topcount &lt;/span&gt;= &lt;span style=&quot;color: #800080;&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;;
            HSSFRow headerRow &lt;/span&gt;= sheet.GetRow(&lt;span style=&quot;color: #800080;&quot;&gt;0&lt;/span&gt; + topcount - &lt;span style=&quot;color: #800080;&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;);
            &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;int&lt;/span&gt; cellCount =&lt;span style=&quot;color: #000000;&quot;&gt; headerRow.LastCellNum;
            System.Collections.Generic.List&lt;/span&gt;&lt;&lt;span style=&quot;color: #0000ff;&quot;&gt;string&lt;/span&gt;&gt; list = &lt;span style=&quot;color: #0000ff;&quot;&gt;new&lt;/span&gt; System.Collections.Generic.List&lt;&lt;span style=&quot;color: #0000ff;&quot;&gt;string&lt;/span&gt;&gt;&lt;span style=&quot;color: #000000;&quot;&gt;();
            &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;for&lt;/span&gt; (&lt;span style=&quot;color: #0000ff;&quot;&gt;int&lt;/span&gt; j = &lt;span style=&quot;color: #800080;&quot;&gt;0&lt;/span&gt;; j &lt; cellCount; j++&lt;span style=&quot;color: #000000;&quot;&gt;)
            {
                HSSFCell cell &lt;/span&gt;=&lt;span style=&quot;color: #000000;&quot;&gt; headerRow.GetCell(j);
                &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;if&lt;/span&gt; (cell == &lt;span style=&quot;color: #0000ff;&quot;&gt;null&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;)
                    &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;continue&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;;
                &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;if&lt;/span&gt; (cell.ToString().Trim().Length &gt; &lt;span style=&quot;color: #800080;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;)
                {
                    list.Add(cell.ToString());
                }
            }
            &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt; list;
        }

        &lt;/span&gt;&lt;span style=&quot;color: #808080;&quot;&gt;///&lt;/span&gt; &lt;span style=&quot;color: #808080;&quot;&gt;&lt;summary&gt;&lt;/span&gt;
        &lt;span style=&quot;color: #808080;&quot;&gt;///&lt;/span&gt; 
        &lt;span style=&quot;color: #808080;&quot;&gt;///&lt;/span&gt; &lt;span style=&quot;color: #808080;&quot;&gt;&lt;/summary&gt;&lt;/span&gt;
        &lt;span style=&quot;color: #808080;&quot;&gt;///&lt;/span&gt; &lt;span style=&quot;color: #808080;&quot;&gt;&lt;param name=&quot;strFileName&quot;&gt;&lt;/param&gt;&lt;/span&gt;
        &lt;span style=&quot;color: #808080;&quot;&gt;///&lt;/span&gt; &lt;span style=&quot;color: #808080;&quot;&gt;&lt;returns&gt;&lt;/returns&gt;&lt;/span&gt;
        &lt;span style=&quot;color: #0000ff;&quot;&gt;public&lt;/span&gt; &lt;span style=&quot;color: #0000ff;&quot;&gt;static&lt;/span&gt; System.Collections.Generic.Dictionary&lt;&lt;span style=&quot;color: #0000ff;&quot;&gt;int&lt;/span&gt;, &lt;span style=&quot;color: #0000ff;&quot;&gt;string&lt;/span&gt;&gt; GetSheetList(&lt;span style=&quot;color: #0000ff;&quot;&gt;string&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt; strFileName)
        {
            HSSFWorkbook hssfworkbook;
            &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;using&lt;/span&gt; (FileStream file = &lt;span style=&quot;color: #0000ff;&quot;&gt;new&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt; FileStream(strFileName, FileMode.Open, FileAccess.Read))
            {
                hssfworkbook &lt;/span&gt;= &lt;span style=&quot;color: #0000ff;&quot;&gt;new&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt; HSSFWorkbook(file);
            }

            System.Collections.Generic.Dictionary&lt;/span&gt;&lt;&lt;span style=&quot;color: #0000ff;&quot;&gt;int&lt;/span&gt;, &lt;span style=&quot;color: #0000ff;&quot;&gt;string&lt;/span&gt;&gt; lists = &lt;span style=&quot;color: #0000ff;&quot;&gt;new&lt;/span&gt; System.Collections.Generic.Dictionary&lt;&lt;span style=&quot;color: #0000ff;&quot;&gt;int&lt;/span&gt;, &lt;span style=&quot;color: #0000ff;&quot;&gt;string&lt;/span&gt;&gt;&lt;span style=&quot;color: #000000;&quot;&gt;();

            &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;for&lt;/span&gt; (&lt;span style=&quot;color: #0000ff;&quot;&gt;int&lt;/span&gt; i = &lt;span style=&quot;color: #800080;&quot;&gt;0&lt;/span&gt;; i &lt; hssfworkbook.NumberOfSheets; i++&lt;span style=&quot;color: #000000;&quot;&gt;)
            {
                lists.Add(i, hssfworkbook.GetSheetName(i));
            }
            &lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt; lists;
        }
    }&lt;/span&gt;</code></pre></div></div>
    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2016/08/03/2016-08-03%2010-40_java%20%E5%AE%9E%E4%BD%93%E5%AF%B9%E8%B1%A1%E8%BD%ACMap%E5%85%AC%E5%85%B1%E7%B1%BB/" rel="prev" title="java 实体对象转Map公共类">
      <i class="fa fa-chevron-left"></i> java 实体对象转Map公共类
    </a></div>
      <div class="post-nav-item">
    <a href="/2016/09/06/2016-09-06%2010-05_cdn/" rel="next" title="cdn">
      cdn <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Li ChengHu</p>
  <div class="site-description" itemprop="description">��ͨ��ֻ�뵽��ζȹ�ʱ�䣬�в��ܵ����跨����ʱ�䡣�����屾��</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">35</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/q111211" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;q111211" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:yourname@gmail.com" title="E-Mail → mailto:yourname@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/yourname" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;yourname" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.cnblogs.com/chenghu/" title="CNBlogs → https:&#x2F;&#x2F;www.cnblogs.com&#x2F;chenghu&#x2F;" rel="noopener" target="_blank"><i class="fab fa-cnBlogs fa-fw"></i>CNBlogs</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Li ChengHu</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
